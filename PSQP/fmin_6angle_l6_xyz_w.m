function  T=fmin(x)
   
    % d1=x(1);d4=x(2);d6=x(3);a1=x(4);a2=x(5);a3=x(6);
    L1 = x(1);
    L2 =  x(2) ;
    L3 = x(3) ;
    L4 = x(4);
    L5 = x(5);
    L6 = x(6);
    angle_err1 = x(7);
    angle_err2 = x(8);
    angle_err3 = x(9);
    angle_err4 = x(10);
    angle_err5 = x(11);
    angle_err6 = x(12);

    m11 = x(13);
    m12 = x(14);
    m13 = x(15);
    m21 = x(16);
    m22 = x(17);
    m23 = x(18);
    m31 = x(19);
    m32 = x(20);
    m33 = x(21);
    m41 = x(22);
    m42 = x(23);
    m43 = x(24);
    m51 = x(25);
    m52 = x(26);
    m53 = x(27);
    m61 = x(28);
    m62 = x(29);
    m63 = x(30);
    
    angle = [
-0.358839694210034,-0.680678408277789,-0.663225115757845,1.16937059883620,-1.65806278939461,0.907571211037051;-0.323933109170148,-0.575958653158129,-0.785398163397448,1.25663706143592,-1.62315620435473,0.802851455917392;-0.777718714688673,-0.663225115757845,-0.890117918517108,0.628318530717959,-1.58824961931484,0.802851455917392;-0.376292986729977,-0.855211333477221,-0.471238898038469,1.11701072127637,-1.55334303427495,0.837758040957278;-0.393746279249921,-0.733038285837618,-0.593411945678072,1.08210413623648,-1.55334303427495,0.890117918517108;-0.428652864289807,-0.855211333477221,-0.349065850398866,1.18682389135614,-1.51843644923507,1.13446401379631;-0.428652864289807,-0.802851455917392,-0.401425727958696,1.13446401379631,-1.51843644923507,1.06465084371654;-0.358839694210034,-0.418879020478639,-0.785398163397448,1.02974425867665,-1.51843644923507,1.09955742875643;-0.358839694210034,-0.750491578357562,-0.750491578357562,0.907571211037051,-1.51843644923507,0.785398163397448;-0.742812129648787,-0.558505360638186,-0.820304748437335,0.767944870877505,-1.51843644923507,0.698131700797732;-0.341386401690091,-0.750491578357562,-0.767944870877505,0.925024503556995,-1.50098315671512,0.698131700797732;-0.411199571769864,-0.802851455917392,-0.314159265358979,1.20427718387609,-1.48352986419518,1.08210413623648;-0.393746279249921,-0.488692190558412,-0.401425727958696,1.25663706143592,-1.46607657167524,1.48352986419518;-0.393746279249921,-0.506145483078356,-0.401425727958696,1.22173047639603,-1.46607657167524,1.32645023151569;-0.358839694210034,-0.610865238198015,-0.663225115757845,1.15191730631626,-1.46607657167524,1.09955742875643;-0.358839694210034,-0.610865238198015,-0.750491578357562,1.13446401379631,-1.46607657167524,0.872664625997165;-0.393746279249921,-0.663225115757845,-0.663225115757845,0.907571211037051,-1.46607657167524,0.977384381116825;-0.341386401690091,-0.209439510239320,-0.610865238198015,1.27409035395586,-1.44862327915529,1.27409035395586;-0.323933109170148,-0.575958653158129,-0.767944870877505,1.18682389135614,-1.44862327915529,0.925024503556995;-0.323933109170148,-0.610865238198015,-0.837758040957278,1.16937059883620,-1.44862327915529,0.872664625997165;-0.428652864289807,-0.837758040957278,-0.488692190558412,0.872664625997165,-1.44862327915529,1.02974425867665;-0.795172007208617,-0.750491578357562,-0.523598775598299,0.733038285837618,-1.44862327915529,1.02974425867665;-0.393746279249921,-0.541052068118242,-0.680678408277789,1.09955742875643,-1.43116998663535,1.08210413623648;-0.376292986729977,-0.680678408277789,-0.506145483078356,1.02974425867665,-1.43116998663535,0.994837673636768;-0.376292986729977,-0.506145483078356,-0.593411945678072,0.942477796076938,-1.43116998663535,1.16937059883620;-0.341386401690091,-0.471238898038469,-0.855211333477221,1.16937059883620,-1.41371669411541,0.925024503556995;-0.393746279249921,-0.558505360638186,-0.506145483078356,1.16937059883620,-1.41371669411541,1.08210413623648;-0.358839694210034,-0.575958653158129,-0.715584993317675,0.994837673636768,-1.41371669411541,0.890117918517108;-0.760265422168730,-0.663225115757845,-0.855211333477221,0.541052068118242,-1.41371669411541,0.785398163397448;-0.411199571769864,-0.593411945678072,-0.331612557878923,1.27409035395586,-1.39626340159546,1.22173047639603;-0.428652864289807,-0.837758040957278,-0.244346095279206,1.09955742875643,-1.39626340159546,1.20427718387609;-0.341386401690091,-0.750491578357562,-0.698131700797732,0.994837673636768,-1.39626340159546,0.680678408277789;-0.725358837128843,-0.575958653158129,-0.628318530717959,0.890117918517108,-1.39626340159546,1.08210413623648;-0.795172007208617,-0.645771823237902,-0.575958653158129,0.663225115757845,-1.39626340159546,0.802851455917392;-0.306479816650204,-0.0349065850398866,-0.593411945678072,1.32645023151569,-1.37881010907552,1.51843644923507;-0.358839694210034,-0.279252680319093,-0.750491578357562,1.23918376891597,-1.37881010907552,1.02974425867665;-0.411199571769864,-0.523598775598299,-0.610865238198015,1.06465084371654,-1.37881010907552,1.04719755119660;-0.428652864289807,-0.767944870877505,-0.383972435438753,1.01229096615671,-1.37881010907552,1.13446401379631;-0.446106156809751,-0.785398163397448,-0.244346095279206,0.977384381116825,-1.37881010907552,1.02974425867665;-0.358839694210034,-0.349065850398866,-0.820304748437335,1.15191730631626,-1.36135681655558,0.959931088596881;-0.393746279249921,-0.733038285837618,-0.488692190558412,1.09955742875643,-1.36135681655558,0.994837673636768;-0.428652864289807,-0.715584993317675,-0.226892802759263,1.09955742875643,-1.36135681655558,1.30899693899575;-0.376292986729977,-0.541052068118242,-0.698131700797732,1.02974425867665,-1.36135681655558,0.977384381116825;-0.428652864289807,-0.802851455917392,-0.418879020478639,1.01229096615671,-1.36135681655558,1.04719755119660;-0.358839694210034,-0.261799387799149,-0.523598775598299,1.36135681655558,-1.34390352403563,1.34390352403563;-0.358839694210034,-0.314159265358979,-0.453785605518526,1.27409035395586,-1.34390352403563,1.34390352403563;-0.358839694210034,-0.157079632679490,-0.785398163397448,1.25663706143592,-1.34390352403563,1.32645023151569;-0.323933109170148,-0.506145483078356,-0.715584993317675,1.22173047639603,-1.34390352403563,1.09955742875643;-0.358839694210034,-0.174532925199433,-0.645771823237902,1.22173047639603,-1.34390352403563,1.48352986419518;-0.358839694210034,-0.261799387799149,-0.523598775598299,1.20427718387609,-1.34390352403563,1.53588974175501;-0.428652864289807,-0.506145483078356,-0.279252680319093,1.18682389135614,-1.34390352403563,1.30899693899575;-0.463559449329694,-1.01229096615671,0.0872664625997165,1.16937059883620,-1.34390352403563,1.29154364647580;-0.463559449329694,-1.02974425867665,0.0174532925199433,1.01229096615671,-1.34390352403563,1.23918376891597;-0.795172007208617,-0.401425727958696,-0.837758040957278,0.872664625997165,-1.34390352403563,1.02974425867665;-0.376292986729977,-0.331612557878923,-0.383972435438753,1.25663706143592,-1.32645023151569,1.25663706143592;-0.341386401690091,-0.122173047639603,-0.593411945678072,1.16937059883620,-1.32645023151569,1.32645023151569;-0.446106156809751,-0.925024503556995,-0.0872664625997165,1.08210413623648,-1.32645023151569,1.06465084371654;-0.376292986729977,-0.349065850398866,-0.802851455917392,0.994837673636768,-1.32645023151569,1.01229096615671;-0.428652864289807,-0.628318530717959,-0.523598775598299,0.977384381116825,-1.32645023151569,0.890117918517108;-0.428652864289807,-0.785398163397448,-0.418879020478639,0.977384381116825,-1.32645023151569,1.04719755119660;-0.306479816650204,-0.0523598775598299,-0.575958653158129,1.39626340159546,-1.30899693899575,1.69296937443450;-0.393746279249921,-0.506145483078356,-0.401425727958696,1.22173047639603,-1.30899693899575,1.20427718387609;-0.393746279249921,-0.628318530717959,-0.628318530717959,1.13446401379631,-1.30899693899575,0.820304748437335;-0.393746279249921,-0.785398163397448,-0.453785605518526,1.08210413623648,-1.30899693899575,0.907571211037051;-0.830078592248503,-0.820304748437335,-0.349065850398866,0.767944870877505,-1.30899693899575,1.09955742875643;-0.760265422168730,-0.279252680319093,-0.907571211037051,0.715584993317675,-1.30899693899575,0.907571211037051;-0.393746279249921,-0.296705972839036,-0.122173047639603,1.44862327915529,-1.29154364647580,1.83259571459405;-0.376292986729977,-0.349065850398866,-0.296705972839036,1.39626340159546,-1.29154364647580,1.50098315671512;-0.323933109170148,-0.0523598775598299,-0.471238898038469,1.37881010907552,-1.29154364647580,1.62315620435473;-0.428652864289807,-0.628318530717959,-0.0349065850398866,1.36135681655558,-1.29154364647580,1.55334303427495;-0.428652864289807,-0.418879020478639,0,1.34390352403563,-1.29154364647580,1.86750229963393;-0.411199571769864,-0.523598775598299,-0.296705972839036,1.30899693899575,-1.29154364647580,1.36135681655558;-0.446106156809751,-0.593411945678072,-0.0523598775598299,1.30899693899575,-1.29154364647580,1.46607657167524;-0.376292986729977,-0.628318530717959,-0.575958653158129,1.22173047639603,-1.29154364647580,0.872664625997165;-0.481012741849637,-0.925024503556995,0.157079632679490,1.15191730631626,-1.29154364647580,1.29154364647580;-0.428652864289807,-0.715584993317675,-0.261799387799149,1.02974425867665,-1.29154364647580,1.20427718387609;-0.428652864289807,-0.715584993317675,-0.488692190558412,0.925024503556995,-1.29154364647580,1.02974425867665;-0.812625299728560,-0.523598775598299,-0.715584993317675,0.698131700797732,-1.29154364647580,0.890117918517108;-0.777718714688673,-0.890117918517108,-0.279252680319093,0.593411945678072,-1.29154364647580,0.994837673636768;-0.323933109170148,0.0174532925199433,-0.506145483078356,1.34390352403563,-1.27409035395586,1.76278254451427;-0.446106156809751,-0.610865238198015,0.0872664625997165,1.27409035395586,-1.27409035395586,1.53588974175501;-0.393746279249921,-0.680678408277789,-0.418879020478639,1.25663706143592,-1.27409035395586,1.09955742875643;-0.463559449329694,-0.994837673636768,0.191986217719376,1.25663706143592,-1.27409035395586,1.48352986419518;-0.428652864289807,-0.488692190558412,-0.226892802759263,1.23918376891597,-1.27409035395586,1.50098315671512;-0.376292986729977,-0.331612557878923,-0.680678408277789,0.977384381116825,-1.27409035395586,1.22173047639603;-0.428652864289807,-0.471238898038469,-0.314159265358979,1.30899693899575,-1.25663706143592,1.32645023151569;-0.393746279249921,-0.471238898038469,-0.418879020478639,1.27409035395586,-1.25663706143592,1.29154364647580;-0.358839694210034,-0.226892802759263,-0.523598775598299,1.27409035395586,-1.25663706143592,1.36135681655558;-0.341386401690091,-0.139626340159546,-0.541052068118242,1.23918376891597,-1.25663706143592,1.50098315671512;-0.446106156809751,-0.471238898038469,-0.139626340159546,1.22173047639603,-1.25663706143592,1.48352986419518;-0.411199571769864,-0.296705972839036,-0.418879020478639,1.18682389135614,-1.25663706143592,1.64060949687467;-0.393746279249921,-0.715584993317675,-0.401425727958696,1.16937059883620,-1.25663706143592,1.02974425867665;-0.376292986729977,-0.191986217719376,-0.314159265358979,1.16937059883620,-1.25663706143592,1.69296937443450;-0.463559449329694,-0.890117918517108,0.122173047639603,1.13446401379631,-1.25663706143592,1.48352986419518;-0.376292986729977,-0.436332312998582,-0.645771823237902,1.08210413623648,-1.25663706143592,1.08210413623648;-0.446106156809751,-0.541052068118242,-0.349065850398866,1.02974425867665,-1.25663706143592,1.27409035395586;-0.463559449329694,-0.855211333477221,-0.244346095279206,0.942477796076938,-1.25663706143592,1.11701072127637;-0.358839694210034,-0.174532925199433,-0.837758040957278,0.872664625997165,-1.25663706143592,1.15191730631626;-0.742812129648787,-0.349065850398866,-0.785398163397448,0.698131700797732,-1.25663706143592,0.994837673636768;-0.411199571769864,-0.331612557878923,-0.226892802759263,1.41371669411541,-1.23918376891597,1.57079632679490;-0.428652864289807,-0.558505360638186,-0.191986217719376,1.34390352403563,-1.23918376891597,1.43116998663535;-0.411199571769864,-0.610865238198015,-0.226892802759263,1.29154364647580,-1.23918376891597,1.48352986419518;-0.446106156809751,-0.593411945678072,-0.0872664625997165,1.27409035395586,-1.23918376891597,1.39626340159546;-0.481012741849637,-0.785398163397448,0.349065850398866,1.27409035395586,-1.23918376891597,1.78023583703422;-0.411199571769864,-0.244346095279206,-0.558505360638186,1.23918376891597,-1.23918376891597,1.34390352403563;-0.376292986729977,-0.174532925199433,-0.750491578357562,1.22173047639603,-1.23918376891597,1.18682389135614;-0.376292986729977,-0.209439510239320,-0.628318530717959,1.18682389135614,-1.23918376891597,1.37881010907552;-0.446106156809751,-0.628318530717959,-0.157079632679490,1.16937059883620,-1.23918376891597,1.25663706143592;-0.446106156809751,-0.785398163397448,-0.122173047639603,1.13446401379631,-1.23918376891597,1.20427718387609;-0.446106156809751,-0.837758040957278,-0.244346095279206,1.08210413623648,-1.23918376891597,1.11701072127637;-0.446106156809751,-0.785398163397448,-0.279252680319093,1.02974425867665,-1.23918376891597,1.08210413623648;-0.393746279249921,-0.558505360638186,-0.541052068118242,0.994837673636768,-1.23918376891597,1.06465084371654;-0.411199571769864,-0.349065850398866,-0.680678408277789,0.925024503556995,-1.23918376891597,1.23918376891597;-0.777718714688673,-0.628318530717959,-0.331612557878923,0.820304748437335,-1.23918376891597,1.23918376891597;-0.376292986729977,-0.244346095279206,-0.279252680319093,1.43116998663535,-1.22173047639603,1.58824961931484;-0.358839694210034,-0.104719755119660,-0.331612557878923,1.36135681655558,-1.22173047639603,1.88495559215388;-0.411199571769864,-0.418879020478639,-0.261799387799149,1.27409035395586,-1.22173047639603,1.48352986419518;-0.428652864289807,-0.575958653158129,-0.226892802759263,1.22173047639603,-1.22173047639603,1.39626340159546;-0.376292986729977,-0.226892802759263,-0.436332312998582,1.20427718387609,-1.22173047639603,1.58824961931484;-0.446106156809751,-0.541052068118242,-0.0698131700797732,1.15191730631626,-1.22173047639603,1.67551608191456;-0.428652864289807,-0.453785605518526,-0.453785605518526,1.11701072127637,-1.22173047639603,1.08210413623648;-0.498466034369581,-0.977384381116825,0.191986217719376,1.09955742875643,-1.22173047639603,1.29154364647580;-0.393746279249921,-0.418879020478639,-0.418879020478639,1.08210413623648,-1.22173047639603,1.29154364647580;-0.463559449329694,-0.820304748437335,-0.0523598775598299,1.06465084371654,-1.22173047639603,1.20427718387609;-0.481012741849637,-1.06465084371654,0.122173047639603,1.02974425867665,-1.22173047639603,1.27409035395586;-0.411199571769864,-0.558505360638186,-0.436332312998582,1.01229096615671,-1.22173047639603,1.16937059883620;-0.760265422168730,-0.506145483078356,-0.523598775598299,0.785398163397448,-1.22173047639603,1.16937059883620;-0.358839694210034,-0.0523598775598299,-0.314159265358979,1.44862327915529,-1.20427718387609,1.83259571459405;-0.323933109170148,-0.0872664625997165,-0.663225115757845,1.30899693899575,-1.20427718387609,1.36135681655558;-0.358839694210034,-0.122173047639603,-0.331612557878923,1.29154364647580,-1.20427718387609,1.64060949687467;-0.446106156809751,-0.418879020478639,-0.401425727958696,1.27409035395586,-1.20427718387609,1.43116998663535;-0.463559449329694,-0.698131700797732,-0.0523598775598299,1.25663706143592,-1.20427718387609,1.36135681655558;-0.358839694210034,-0.139626340159546,-0.366519142918809,1.23918376891597,-1.20427718387609,1.58824961931484;-0.358839694210034,-0.261799387799149,-0.558505360638186,1.22173047639603,-1.20427718387609,1.43116998663535;-0.463559449329694,-0.855211333477221,0.104719755119660,1.15191730631626,-1.20427718387609,1.34390352403563;-0.463559449329694,-0.663225115757845,0.0174532925199433,1.13446401379631,-1.20427718387609,1.55334303427495;-0.446106156809751,-0.767944870877505,-0.209439510239320,1.06465084371654,-1.20427718387609,1.16937059883620;-0.795172007208617,-0.733038285837618,-0.471238898038469,0.506145483078356,-1.20427718387609,1.02974425867665;-0.341386401690091,-0.0174532925199433,-0.331612557878923,1.41371669411541,-1.18682389135614,1.98967534727354;-0.446106156809751,-0.418879020478639,-0.226892802759263,1.39626340159546,-1.18682389135614,1.48352986419518;-0.393746279249921,-0.261799387799149,-0.349065850398866,1.34390352403563,-1.18682389135614,1.57079632679490;-0.446106156809751,-0.383972435438753,-0.261799387799149,1.32645023151569,-1.18682389135614,1.50098315671512;-0.428652864289807,-0.261799387799149,-0.383972435438753,1.15191730631626,-1.18682389135614,1.58824961931484;-0.498466034369581,-0.715584993317675,0.0349065850398866,1.09955742875643,-1.18682389135614,1.50098315671512;-0.428652864289807,-0.523598775598299,-0.349065850398866,1.04719755119660,-1.18682389135614,1.43116998663535;-0.428652864289807,-0.698131700797732,-0.314159265358979,1.01229096615671,-1.18682389135614,1.16937059883620;-0.463559449329694,-0.610865238198015,-0.174532925199433,1.01229096615671,-1.18682389135614,1.39626340159546;-0.777718714688673,-0.279252680319093,-0.802851455917392,0.628318530717959,-1.18682389135614,1.01229096615671;-0.393746279249921,-0.191986217719376,-0.191986217719376,1.34390352403563,-1.16937059883620,1.95476876223365;-0.446106156809751,-0.575958653158129,0.0872664625997165,1.30899693899575,-1.16937059883620,1.72787595947439;-0.481012741849637,-0.331612557878923,-0.104719755119660,1.29154364647580,-1.16937059883620,1.72787595947439;-0.446106156809751,-0.523598775598299,-0.174532925199433,1.25663706143592,-1.16937059883620,1.37881010907552;-0.446106156809751,-0.855211333477221,-0.0523598775598299,1.23918376891597,-1.16937059883620,1.15191730631626;-0.393746279249921,-0.157079632679490,-0.418879020478639,1.20427718387609,-1.16937059883620,1.39626340159546;-0.446106156809751,-0.663225115757845,-0.0349065850398866,1.11701072127637,-1.16937059883620,1.37881010907552;-0.463559449329694,-0.837758040957278,-0.0349065850398866,1.02974425867665,-1.16937059883620,1.27409035395586;-0.795172007208617,-0.401425727958696,-0.733038285837618,0.523598775598299,-1.16937059883620,1.01229096615671;-0.358839694210034,-0.191986217719376,-0.383972435438753,1.39626340159546,-1.15191730631626,1.41371669411541;-0.376292986729977,-0.209439510239320,-0.244346095279206,1.37881010907552,-1.15191730631626,1.85004900711399;-0.463559449329694,-0.331612557878923,0,1.25663706143592,-1.15191730631626,1.74532925199433;-0.393746279249921,-0.488692190558412,-0.453785605518526,1.22173047639603,-1.15191730631626,1.29154364647580;-0.463559449329694,-0.942477796076938,0.0698131700797732,1.16937059883620,-1.15191730631626,1.11701072127637;-0.428652864289807,-0.628318530717959,-0.261799387799149,1.15191730631626,-1.15191730631626,1.22173047639603;-0.463559449329694,-0.855211333477221,0,1.13446401379631,-1.15191730631626,1.41371669411541;-0.463559449329694,-0.610865238198015,-0.157079632679490,1.08210413623648,-1.15191730631626,1.34390352403563;-0.428652864289807,-0.383972435438753,-0.436332312998582,1.02974425867665,-1.15191730631626,1.25663706143592;-0.446106156809751,-0.645771823237902,-0.331612557878923,0.925024503556995,-1.15191730631626,1.29154364647580;-0.411199571769864,-0.366519142918809,-0.558505360638186,0.890117918517108,-1.15191730631626,1.25663706143592;-0.760265422168730,-0.977384381116825,-0.0349065850398866,0.733038285837618,-1.15191730631626,1.15191730631626;-0.864985177288390,-0.244346095279206,-0.750491578357562,0.575958653158129,-1.15191730631626,0.994837673636768;-0.306479816650204,0.104719755119660,-0.471238898038469,1.50098315671512,-1.13446401379631,1.93731546971371;-0.446106156809751,-0.593411945678072,0.104719755119660,1.41371669411541,-1.13446401379631,1.67551608191456;-0.323933109170148,0.0698131700797732,-0.453785605518526,1.32645023151569,-1.13446401379631,1.64060949687467;-0.393746279249921,-0.279252680319093,-0.383972435438753,1.25663706143592,-1.13446401379631,1.43116998663535;-0.446106156809751,-0.593411945678072,-0.209439510239320,1.20427718387609,-1.13446401379631,1.18682389135614;-0.463559449329694,-0.541052068118242,-0.122173047639603,1.04719755119660,-1.13446401379631,1.50098315671512;-0.428652864289807,-0.663225115757845,-0.383972435438753,1.01229096615671,-1.13446401379631,1.06465084371654;-0.306479816650204,0.0523598775598299,-0.401425727958696,1.51843644923507,-1.11701072127637,1.86750229963393;-0.446106156809751,-0.506145483078356,0.0698131700797732,1.39626340159546,-1.11701072127637,1.74532925199433;-0.463559449329694,-0.593411945678072,0.226892802759263,1.29154364647580,-1.11701072127637,1.88495559215388;-0.446106156809751,-0.523598775598299,0,1.25663706143592,-1.11701072127637,1.69296937443450;-0.446106156809751,-0.436332312998582,0,1.22173047639603,-1.11701072127637,1.78023583703422;-0.376292986729977,-0.383972435438753,-0.523598775598299,1.18682389135614,-1.11701072127637,1.22173047639603;-0.411199571769864,-0.296705972839036,-0.401425727958696,1.18682389135614,-1.11701072127637,1.51843644923507;-0.428652864289807,-0.418879020478639,-0.296705972839036,1.09955742875643,-1.11701072127637,1.41371669411541;-0.393746279249921,-0.349065850398866,-0.575958653158129,1.06465084371654,-1.11701072127637,1.32645023151569;-0.830078592248503,-0.104719755119660,-0.680678408277789,0.977384381116825,-1.11701072127637,1.36135681655558;-0.795172007208617,-0.279252680319093,-0.558505360638186,0.733038285837618,-1.11701072127637,1.13446401379631;-0.463559449329694,-0.593411945678072,0.261799387799149,1.43116998663535,-1.09955742875643,1.88495559215388;-0.463559449329694,-0.593411945678072,0.0698131700797732,1.29154364647580,-1.09955742875643,1.44862327915529;-0.481012741849637,-0.575958653158129,0.226892802759263,1.27409035395586,-1.09955742875643,1.76278254451427;-0.481012741849637,-0.837758040957278,0.209439510239320,1.23918376891597,-1.09955742875643,1.46607657167524;-0.481012741849637,-0.820304748437335,0.244346095279206,1.22173047639603,-1.09955742875643,1.58824961931484;-0.358839694210034,-0.0872664625997165,-0.418879020478639,1.22173047639603,-1.09955742875643,1.72787595947439;-0.376292986729977,-0.209439510239320,-0.488692190558412,1.16937059883620,-1.09955742875643,1.39626340159546;-0.393746279249921,-0.436332312998582,-0.541052068118242,1.13446401379631,-1.09955742875643,1.09955742875643;-0.498466034369581,-0.767944870877505,0.0872664625997165,1.01229096615671,-1.09955742875643,1.53588974175501;-0.463559449329694,-0.628318530717959,-0.209439510239320,0.907571211037051,-1.09955742875643,1.41371669411541;-0.830078592248503,-0.104719755119660,-0.802851455917392,0.872664625997165,-1.09955742875643,1.11701072127637;-0.812625299728560,-0.453785605518526,-0.558505360638186,0.575958653158129,-1.09955742875643,0.942477796076938;-0.446106156809751,-0.418879020478639,0.139626340159546,1.46607657167524,-1.08210413623648,1.86750229963393;-0.481012741849637,-0.698131700797732,0.139626340159546,1.36135681655558,-1.08210413623648,1.48352986419518;-0.411199571769864,-0.349065850398866,-0.122173047639603,1.36135681655558,-1.08210413623648,1.57079632679490;-0.446106156809751,-0.453785605518526,-0.139626340159546,1.36135681655558,-1.08210413623648,1.57079632679490;-0.323933109170148,0.0174532925199433,-0.471238898038469,1.36135681655558,-1.08210413623648,1.67551608191456;-0.446106156809751,-0.453785605518526,0.139626340159546,1.30899693899575,-1.08210413623648,1.93731546971371;-0.481012741849637,-0.733038285837618,0.349065850398866,1.23918376891597,-1.08210413623648,1.91986217719376;-0.446106156809751,-0.209439510239320,-0.314159265358979,1.22173047639603,-1.08210413623648,1.50098315671512;-0.463559449329694,-0.610865238198015,-0.0872664625997165,1.18682389135614,-1.08210413623648,1.55334303427495;-0.463559449329694,-0.610865238198015,0.0698131700797732,1.16937059883620,-1.08210413623648,1.44862327915529

];


    pr = [   


    1136.52904207976,-695.287311992910,758.469344978096;1058.63627176560,-630.143125506423,789.648097619269;778.799683700364,-993.749671893293,677.953761247354;1255.39411120520,-761.755830366391,638.312128473681;1184.01491288904,-754.422650579134,714.423652697613;1277.10816986841,-863.674834626673,684.100914510146;1263.36655103681,-851.004360737063,721.662097851459;1097.76705408955,-662.518658559804,917.186531096260;1141.07278827753,-658.643110681903,627.980841725362;823.733981012380,-1015.17064663154,784.203977425952;1134.82858175241,-635.030812605150,616.718764516152;1317.35151896041,-853.523739725913,755.214918140336;1248.47856247848,-800.242397757285,1052.35017729170;1259.93243773467,-801.664655097065,1038.51263196801;1156.94848926367,-700.398112626388,776.470528961327;1099.89630029744,-676.629845206974,737.260220716552;1192.86607495096,-728.554903813358,738.944082066512;1111.11521927657,-670.856332096828,1177.98631419276;1099.49736865690,-635.310116662580,753.887236884635;1048.40904434809,-616.106352023679,696.828383346627;1275.06126119239,-812.618169910713,634.851152364384;925.774952633558,-1205.94298390706,723.755058398982;1137.29688303978,-734.744389373147,830.928854714017;1280.92077460057,-757.060306463522,788.525866805155;1241.53570535866,-727.254353420330,934.103546871972;1035.06179388067,-632.029051408714,797.796276917374;1231.32722142213,-781.884334432289,904.867088365500;1166.34268189682,-680.237962110166,781.088113784011;840.589003960159,-992.387185655089,644.659233583289;1294.52322928418,-847.123359428910,963.483002670327;1376.84185844758,-894.810282508346,744.972136365550;1172.19824457039,-656.915888657550,612.882640281819;919.668677119090,-1096.85473421748,832.658255717719;925.609553612237,-1182.67369135528,802.819934449370;1072.39829431998,-612.784583822870,1324.30581221323;1064.04731438730,-670.487173594196,1006.48291576058;1181.90923339929,-772.402148187255,879.069498298819;1320.86640485644,-855.405940321985,748.216550592539;1394.23299966952,-915.219111645437,822.199508922446;1052.68264174146,-656.256238097013,907.982311423464;1264.15892460677,-784.451416893392,715.637008083099;1389.96747822272,-898.978309047747,905.553921072612;1161.59685394321,-706.350098896770,808.598885576211;1296.84859154856,-843.417529791028,681.174012867532;1157.12139770493,-713.175536219727,1156.80818005299;1221.53303043899,-731.323270331468,1173.74632961286;1019.21957756280,-653.288642184353,1077.34040652923;1137.92531221082,-646.907004450765,812.798971168772;1101.24560737820,-680.861430207474,1170.86193386939;1187.82329007014,-711.902688870813,1185.12851266247;1313.47271195653,-873.247301284843,1110.39110413447;1499.07093730290,-1026.01400687258,712.805355652146;1497.17799684975,-1003.39592123448,658.370873966375;740.067588616553,-1047.67396196746,869.040581459833;1249.41837823544,-766.047021518171,1211.05538984352;1128.36168753183,-660.543135948474,1267.55350572819;1455.67210410443,-957.895765778142,719.470790226244;1094.38353700226,-672.151999946669,924.130260147292;1251.94616706525,-814.981562343912,814.322026892704;1310.37299181554,-842.026000749700,695.471984852598;1090.15850892821,-618.087331318485,1297.22206007938;1285.08681074190,-803.829879346064,1003.46015404284;1171.43622845554,-746.690330805300,736.663425776664;1290.50273238969,-789.882121133108,662.973315174442;960.707930891789,-1325.49742583162,707.231880139094;775.286474492797,-977.503884369029,937.397953699971;1272.70308403835,-812.492222800007,1427.83425293922;1271.03950190463,-781.756165101425,1229.48862334208;1117.89407132595,-647.893851791970,1387.89324894428;1417.88040258219,-932.447757223969,1110.61046405559;1344.06077946307,-897.294303280441,1416.10970554015;1309.94372668862,-849.822475237330,1043.68909310592;1394.23097988495,-950.055303085826,1152.93344507737;1200.78666951650,-741.077152465110,752.809177327707;1525.56237407231,-1069.54084166622,887.347173514311;1397.32751530571,-888.225280456938,872.862758374532;1286.42092941495,-820.134142733904,731.035062450502;833.862615636218,-1127.91509042453,819.383459465851;1101.79108712641,-1294.30676483479,669.061645766635;1078.97968365308,-631.280849112988,1425.04396128905;1449.14990197490,-972.226432949430,1255.26398007611;1283.63899047942,-804.012207713402,778.118578718552;1542.21904195267,-1051.56016140491,788.827245392619;1331.97505893531,-882.275029577382,1150.93198713537;1175.33516555329,-698.239969734077,1012.05509627745;1281.83103321319,-863.177951212193,1085.01300375643;1267.14124188899,-796.989150710434,1010.58071213398;1178.61490703041,-708.439844016107,1190.47515325876;1156.17241860363,-672.281328929190,1268.55627387658;1346.41973517055,-916.343668436508,1247.37266148269;1222.09307474522,-797.180577355617,1219.72365552382;1316.08064188808,-807.429829172317,753.459265983961;1233.76397851925,-745.821205698647,1429.15265870100;1537.32387677384,-1034.41104505115,906.527480586806;1188.46064920220,-717.304844568795,914.193041555623;1322.26721354908,-880.895731297148,1018.30319853647;1396.20276136435,-934.915486497800,703.561846607308;1091.64826158086,-622.457562348755,1052.83973598426;868.404273341778,-1025.48697541409,941.656523960286;1267.52799825115,-832.596679429419,1296.61821096644;1352.54233081894,-896.569550360884,1066.50657907242;1371.69747031128,-871.118382651601,982.353893384958;1399.00097963711,-944.886115668776,1120.96354753246;1540.00643209257,-1085.17303050434,1233.46555387981;1140.05932584229,-764.674425815609,1147.51832456190;1054.46677540290,-678.195045287985,1068.95179150884;1133.26959417721,-706.151194950911,1135.15458324451;1399.27418123167,-934.724105242863,1035.78804256529;1441.14111084118,-950.888815149802,857.831394375891;1382.99480609786,-916.207378197930,707.837163209458;1378.13605574078,-906.402410137072,757.426767021881;1271.24257426618,-764.046290243201,857.680820584673;1169.02921168991,-735.631434954490,991.556098242588;1029.29660911259,-1281.71776306210,944.242060801446;1241.55964630518,-765.104264204506,1342.02037289711;1174.58603807352,-709.706795956483,1456.74130415427;1315.86422252769,-843.073828180617,1189.89210762629;1367.20384596620,-891.770098373623,1034.50389417539;1218.95451946681,-740.466365385415,1270.03395508686;1411.98729460297,-937.320272333558,1226.15817044868;1256.19401095199,-829.237485987274,1019.92016001993;1545.18755256812,-1104.20724349531,830.771233790153;1301.00639452483,-787.369638225583,1092.56980480663;1477.23392689519,-991.722736566768,869.811334211076;1540.79180750288,-1055.05780239252,652.226726029049;1317.58689715469,-813.695968102969,924.828321891915;968.703314690715,-1173.99587205107,945.644511825165;1140.14708748426,-698.721204030910,1501.97963073645;1095.27563922866,-628.067922148357,1192.67246298941;1198.09886521893,-711.890873292157,1452.48714584600;1230.55252459131,-860.249836147110,1072.08076813332;1428.83459587604,-987.611810156888,1005.60174697722;1207.57325418868,-711.434188386166,1413.84380643406;1193.44515378597,-704.606009735925,1125.39673181531;1533.47141407668,-1029.57458973887,930.186707947803;1468.09879224186,-994.576288542287,1136.15605193097;1414.82253638472,-926.098400307440,817.299281731557;1023.84400573714,-1223.09425552901,723.245315849041;1134.48639267655,-669.175698749560,1525.65530043159;1285.63438061481,-892.881161862633,1189.54776548404;1234.92103547884,-781.511634517320,1274.82698203726;1271.95888282608,-882.202706408520,1215.01356971098;1226.39479904899,-816.263235756649,1281.47761765989;1460.99782748721,-1054.58242662125,1079.95733691664;1340.79918179040,-855.764229615627,1021.20840096733;1384.66294342482,-870.903287245165,833.620435536234;1411.75048093357,-947.829749250830,1058.45043940532;838.726518617711,-1036.24725543899,984.229467004007;1240.46060215197,-781.907265285360,1491.64998422934;1454.21409390949,-966.830070062986,1280.36445023640;1266.93473562905,-935.425421267997,1423.66519673083;1364.08550601441,-919.458033997254,1128.22024479286;1466.47674104447,-967.334969644358,783.547120063602;1190.65059180186,-749.740671422492,1349.59628110312;1477.52379997592,-959.259548718069,1086.49142664796;1501.31212297226,-993.761840185231,851.885099653661;890.394992529342,-1089.17047644011,912.949033920517;1219.20588315022,-720.732487335362,1302.74908035476;1255.15344172109,-760.341283817762,1413.92250957987;1304.96153573521,-919.242315546394,1528.14124725476;1278.06920107276,-786.301129443086,949.515742445809;1525.68450724988,-1021.89986572682,758.596134325038;1383.91040546695,-885.049279406963,935.932306385321;1499.73405861781,-1004.98113701365,835.727125698704;1411.31751712350,-953.781201607203,1054.96586164482;1277.29954729347,-820.330638901480,1110.93553286660;1380.58177886253,-882.890374904839,888.731757215856;1256.22004356905,-760.565149003395,1048.91390094422;1207.42643094268,-1382.03101397421,677.070299007443;776.556046526751,-1122.54000875249,1054.27426955454;1060.85838709841,-594.878793436702,1479.30817734465;1460.47470870732,-971.644384296507,1244.60334950007;1092.62385066799,-620.484379868927,1505.41917838867;1254.70060307845,-777.263903394662,1233.03429176370;1381.51783326752,-918.666849277126,1011.04567237231;1414.74038923228,-948.847862619573,1181.55598313034;1348.87433231924,-848.996293133306,814.548306103572;1109.18626360186,-608.416161760274,1493.45031026048;1421.51306360192,-949.796111586324,1333.48407856246;1483.97769047388,-1007.98360477928,1383.47904250440;1430.59884168982,-945.227633836735,1274.68915319199;1394.27725145718,-924.608881193341,1397.97441372764;1248.70235391315,-739.283978684533,1010.57297098749;1255.87000318573,-797.055353590267,1207.62296582143;1338.74961493874,-853.690003075634,1170.74481530150;1225.17407510169,-742.589332732945,1024.21113286969;726.557209763986,-1098.10066559535,1198.06075344443;900.152016945218,-1154.82733671748,1155.25173750897;1479.19933181488,-1011.37260208700,1383.39673354877;1458.26770218068,-992.834911253185,1233.35559206715;1463.40253242328,-1028.51432931353,1410.31936074901;1556.21322275270,-1074.40490100007,1011.96273739964;1566.14040805850,-1078.01912897404,1073.52758740544;1191.94407764788,-692.155706519930,1406.41008066095;1222.55836699941,-724.685061883329,1226.12236969272;1246.67895490682,-757.749885733082,943.333633267408;1521.66806569974,-1065.76825579332,1046.95724115637;1433.82433190860,-933.344293197173,1000.15268013946;708.905297420420,-1053.02227765028,1104.57656878762;946.035627833732,-1194.13538968449,965.513051020256;1387.09517555894,-931.181692639133,1496.12279138157;1488.60227075716,-1045.35134580142,1131.03315808130;1347.25259734492,-846.444653274043,1359.46154267519;1356.30084639136,-911.812144125073,1212.60390634784;1130.36758847163,-628.729192583109,1427.24247736677;1421.18599297108,-939.826292473751,1485.53783350868;1560.96530655731,-1074.59789628532,1300.50081424562;1219.31061791723,-835.565504795184,1371.95073580361;1432.76506316214,-968.275959348261,1083.92347608728;1485.83167530426,-993.055937650491,1230.06591995213
  
];


   
     M=[ 0  0 1 L4 + L5 + L6;
         0 -1 0            0;
         1  0 0 L1 + L2 + L3;
         0  0 0            1 ]  ;


    Slist = [[m11; m12; m13 ;                     -L1 * (m12);                             L1 * (m11);                              0], ...d
            [m21; m22; m23;                       -L1 * (m22);                            -m23*L6 + m21*L1;                           L6*m22],...
            [m31; m32; m33;                       -m32*(L1 + L2);            -m33*L6+m31*(L1 + L2);       m32*L6],...
            [m41; m42; m43;                      -m42*(L1 + L2+ L3);            -m43*L6+m41*(L1 + L2+ L3);       m42*L6],...
            [m51; m52; m53;                        -m52*(L1 + L2+ L3);            -m53*(L6+L4) + m51*(L1 + L2+ L3);       m52*(L6+L4)],...
            [1; 0; 0;                     -m62*(L1 + L2+ L3);            -m63*(L6+L4+L5) + m61*(L1 + L2+ L3);       m62*(L6+L4+L5)]];
        

dimension = size(pr);
    for i = 1 :  dimension(1)
        theta1 = angle(i,1) + angle_err1;
        theta2 = angle(i,2) + angle_err2;
        theta3 = angle(i,3) + angle_err3;
        theta4 = angle(i,4) + angle_err4;
        theta5 = angle(i,5) + angle_err5;
        theta6 = angle(i,6)+ angle_err6;


        thetalist = [theta1; theta2;  theta3;  theta4;  theta5; theta6];
        Ts = FKinSpace(M,Slist,thetalist);
        err(i,:) = Ts(1:3,4)' - pr(i,:);
    end
    temp =  err.^2 ;
    temp = temp(:,1) +temp(:,2) +temp(:,3);
    temp = sqrt(temp);
    temp( find(temp == max(temp))) = 0;
    temp( find(temp == max(temp))) = 0;
    temp( find(temp == max(temp))) = 0;


    T=sum(temp);


end